<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dias de descanso</title>

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        #calendar {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        #calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #333;
            color: #fff;
        }

        #days {
            display: flex;
            /* justify-content: space-between; */
            justify-content: space-around;
            padding: 10px;
            background: #333;
            color: #fff;

            div {
                text-align: center;
            }
        }

        #calendar-body {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #333;

            div {
                padding: 20px;
                background: #fff;
                text-align: center;
            }

            div.today {
                background: #f00;
                color: #fff;
            }

            .descanso {
                color: #fff;
                background: blue;
            }
        }

        .change-month {
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h1>Dias de descanso</h1>
    <div id="calendar">
        <div id="calendar-header">
            <span id="month-prev" class="change-month">&lt;</span>
            <h2 id="month"></h2>
            <span id="month-next" class="change-month">&gt;</span>
        </div>
        <div id="days"></div>
        <div id="calendar-body">

        </div>
    </div>

    <script>

        const diaDescanso = 13;
        let sumaDias = 0;
        let restaDias = 0;
        let diasFaltantesTerminarMes = 0;
        let posicionArray = 0;
        let diasSeleccionados = [];
        let ultimoDiaMes = 0;
        let nuevoValorDiaDesc = 0;


        let date = new Date();

        function renderCalendar() {
            sumaDias = diaDescanso;
            date.setDate(1);

            const monthDays = document.getElementById('calendar-body');
            const month = document.getElementById('month');
            const daysElement = document.getElementById('days');

            //ultimo dia del mes - cantidad de dias que tiene el mes
            const lastDay = new Date(
                date.getFullYear(),
                date.getMonth() + 1,
                0
            ).getDate();

            //imprime 31 
            const prevLastDay = new Date(
                date.getFullYear(),
                date.getMonth(),
                0
            ).getDate();

            const firstDayIndex = date.getDay(); //imprime 0

            //imprime 1
            const lastDayIndex = new Date(
                date.getFullYear(),
                date.getMonth() + 1,
                0
            ).getDay();

            const nextDays = 7 - lastDayIndex - 1; //imprime 5 dias faltantes para terminar la semana pte x verificar

            const months = [
                'Enero',
                'Febrero',
                'Marzo',
                'Abril',
                'Mayo',
                'Junio',
                'Julio',
                'Agosto',
                'Septiembre',
                'Octubre',
                'Noviembre',
                'Diciembre'
            ];

            const days = [
                'DOM',
                'LUN',
                'MAR',
                'MIE',
                'JUE',
                'VIE',
                'SAB'
            ];

            month.innerText = `${months[date.getMonth()]} ${date.getFullYear()}`; //imprime nombre del mes
            daysElement.innerHTML = days.map(day => `<div>${day}</div>`).join(''); //imprime los dias de Dom a Sab

            let dates = '';

            for (let x = firstDayIndex; x > 0; x--) {
                dates += `<div class='prev-date'>${prevLastDay - x + 1}</div>`;
            }

            //Impresion de los dias del mes que se ve
            for (let i = 1; i <= lastDay; i++) {
                // ---------------------
                if (date.getMonth() === new Date().getMonth() &&
                    date.getFullYear() === new Date().getFullYear()) {


                    if (
                        i === new Date().getDate()
                        // &&
                        // date.getMonth() === new Date().getMonth() &&
                        // date.getFullYear() === new Date().getFullYear()
                    ) {
                        dates += `<div class="today">${i}</div>`; //dia actual (hoy)
                    }
                    else if (
                        i === sumaDias &&
                        date.getMonth() === new Date().getMonth() &&
                        date.getFullYear() === new Date().getFullYear()
                        // && i <= lastDay
                    ) {
                        dates += `<div class="descanso">${i}</div>`;

                        sumaDias += 8; //37

                        ultimoDiaMes = sumaDias; //37
                        restaDias = lastDay;
                    }

                    else {
                        dates += `<div>${i}</div>` //dias del mes actual
                    }
                }

                else {
                    //asigno el nuevo valor del dia de desc
                    if (ultimoDiaMes >= lastDay && nuevoValorDiaDesc === 0) {
                        // ultimoDiaMes - restaDias;
                            // console.log(ultimoDiaMes - restaDias)
                            nuevoValorDiaDesc = ultimoDiaMes - restaDias;
                            console.log(nuevoValorDiaDesc);
                    }
                    if (i === nuevoValorDiaDesc) {
                        dates += `<div class="descanso">${i}</div>`;
                        nuevoValorDiaDesc += 8;
                    }
                    else {
                        dates += `<div>${i}</div>` //dias del resto de meses
                        // console.log(restaDias);
                    }

                }

            }

            for (let j = 1; j <= nextDays; j++) {
                dates += `<div class="next-date">${j}</div>`; //dias del proximo mes en la misma pantalla
            }

            monthDays.innerHTML = dates; //imprime los dias en el html (inserta)
        }

        document.getElementById('month-prev').addEventListener('click', () => {
            document.getElementById('calendar-body').classList.add('fade-out');
            setTimeout(() => {
                date.setMonth(date.getMonth() - 1); //asigna el mes
                renderCalendar();
                document.getElementById('calendar-body').classList.remove('fade-out');
            }, 500);
        });

        document.getElementById('month-next').addEventListener('click', () => {
            document.getElementById('calendar-body').classList.add('fade-out');
            setTimeout(() => {
                date.setMonth(date.getMonth() + 1);//asigna el mes
                renderCalendar();
                document.getElementById('calendar-body').classList.remove('fade-out');
            }, 500);
        });

        renderCalendar();
    </script>
</body>

</html>